<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>FDA and BMD Prediction</title>
  <meta name="description" content="">
  <meta name="author" content="Steve Lane">
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <link rel="stylesheet" href="../libraries/frameworks/revealjs/css/reveal.min.css">
  <link rel="stylesheet" href="../libraries/frameworks/revealjs/css/theme/sky.css" id="theme">
  <link rel="stylesheet" href="../libraries/highlighters/highlight.js/css/tomorrow.css" id="theme">
  <!--[if lt IE 9]>
  <script src="lib/js/html5shiv.js"></script>
  <![endif]-->  <link rel="stylesheet" href = "../assets/css/ribbons.css">

</head>
<body>
  <div class="reveal">
    <div class="slides">
      <section class='' data-state='' id='slide-1'>

  <!-- To compile: -->

<!-- require(slidify) -->

<!-- slidify("BiosDayDeakin2014.rmd") -->

<!-- Post creation need to edit html to adjust height and width. -->

<h2>Prediction of bone mineral density trajectories</h2>

<h3>Functional data analytic approach</h3>

<h4>Steve Lane</h4>

<h5>stephen.lane &#39;at&#39; barwonhealth.org.au</h5>

<h5>Barwon Health Biostatistics Unit</h5>

<!-- Date (if required): -->

<!-- ##### Tuesday September 16, 2014 -->

<p><aside class="notes"></p>

<ul>
<li>Kept here as a placeholder</li>
</ul>

<p></aside></p>

</section>
<section class='' data-state='' id='slide-2'>

  <p><section></p>

<h2>What is functional data analysis?</h2>

<!-- Include R logo? -->

</section>
<section class='' data-state='' id='slide-3'>
  <h3>Two scenarios</h3>
  <ul>
<li>But one theme!</li>
<li>Object of analysis is a curve observed on a:

<ul>
<li>dense grid, over the full domain of interest</li>
<li>sparse grid, within a subset of the domain of interest</li>
</ul></li>
</ul>

</section>
<section class='' data-state='' id='slide-4'>
  <h3>Fine grid, full measurement domain</h3>
  <!-- Example from my regression tree paper? Cool interactive graph! -->

<ul>
<li><a href="http://www.psych.mcgill.ca/misc/fda/">Handwriting example</a></li>
</ul>

</section>
<section class='' data-state='' id='slide-5'>
  <h3>Sparse grid, subset of measurement domain</h3>
  <iframe src="f0.html" width=1280 height=720></iframe>

</section>
<section class='' data-state='' id='slide-6'>
  <h3>(Some) mathematical/statistical details</h3>
  <h4>(for the sparse case)</h4>

<!-- Slide (or a couple) to include the nuts and bolts -->

<!-- Refs as footers, as it doesn't work with pandoc yet. -->

<ul>
<li>Assume that \(Y_{i}(t_{ij})\) are BMD observations</li>
<li>\(E[X(t)] = \mu(t)\)</li>
<li>\(\text{cov}[X(t), X(s)] = G(t, s)\)</li>
<li>The functional model can be written as
\[
\begin{aligned}
Y_{i}(t) & = X_{i}(t) + \epsilon_{i}(t)
\end{aligned}
\]</li>
</ul>

</section>
<section class='' data-state='' id='slide-7'>
  <h3>Mixed models representation</h3>
  <ul>
<li>The subject specific curves are considered as deviations from the mean
\[
\begin{aligned}
X_{i}(t) & = \mu(t) + \eta_{i}(t)
\end{aligned}
\]
with \(\eta_{i}(t)\) modelled as a combination of basis functions, to give
\[
\begin{aligned}
Y_{i}(t_{ij}) & = \mu(t_{ij}) + \sum_{k=1}^{K}\xi_{ik}\psi_{k}(t_{ij}) +
\epsilon_{i}(t_{ij})
\end{aligned}
\]</li>
</ul>

</section>
<section class='' data-state='' id='slide-8'>
  <h3>Estimation of parameters</h3>
  <ul>
<li>We treat the basis functions \(\psi_{k}(t)\) as fixed
\[
\begin{aligned}
G(s, t) & = \sum_{k=1}^{\infty}\lambda_{k}\psi_{k}(s)\psi_{k}(t) \\
X(t) - \mu(t) & = \sum_{k=1}^{\infty}\xi_{k}\psi_{k}(t) \\
\end{aligned}
\]</li>
<li>Two main approaches:

<ul>
<li>Use the BLUP</li>
<li>MCMC</li>
</ul></li>
</ul>

<p></section></p>

</section>
<section class='' data-state='' id='slide-9'>

  <p><section></p>

<h2>Application to a longitudinal cohort study</h2>

</section>
<section class='' data-state='' id='slide-10'>
  <h3>Geelong Osteoporosis Study (GOS)</h3>
  <!-- Slides (perhaps multiple) of GOS description -->

<ul>
<li>Prospective cohort study</li>
<li>Originally designed to address

<ul>
<li>Osteoporosis prevalence</li>
<li>Age-related BMD change</li>
<li>Osteoporosis and fracture risk</li>
</ul></li>
<li>Also collects

<ul>
<li>Depressive and anxiety disorders (questionnaires and SCIDs)</li>
<li>Diet and alcohol</li>
</ul></li>
</ul>

</section>
<section class='' data-state='' id='slide-11'>
  <h3>GOS Cohort</h3>
  <ul>
<li>Age stratified</li>
<li>Barwon statistical division/electoral roll</li>
<li>At baseline

<ul>
<li>1494 women (1993-1997)</li>
<li>1540 men (2001-2006)</li>
</ul></li>
</ul>

</section>
<section class='' data-state='' id='slide-12'>
  <h3>The importance of BMD</h3>
  <!-- This is a bit of an 'aside' slide -->

<ul>
<li>BMD is used to define osteoporosis</li>
<li>Much like BMI, this is seemingly arbitrary

<ul>
<li>Osteoporosis: BMD \(<2.5\) sd below the reference mean (!)</li>
</ul></li>
<li>Predicting individual trajectories hopefully leads to improved planning and
patient management</li>
</ul>

</section>
<section class='' data-state='' id='slide-13'>
  <h3>Can we use FDA to fit and then predict future BMD trajectories?</h3>
  <!-- Details of process, cross-validation study, metrics used to see if it works -->

<!-- -->

<!-- This could be better as a series of figures, highlighting one trajectory -->

<!-- and looking at where it fits in. -->

<ul>
<li>Accuracy of fitted curves show via simulated data

<ul>
<li>We don&#39;t have the true curves (like all applied work!)</li>
</ul></li>
<li>Accuracy of future values (predictions/forecasts)

<ul>
<li>We do have these</li>
<li>But they&#39;re measured with error as well!</li>
</ul></li>
</ul>

</section>
<section class='' data-state='' id='slide-14' data-transition='none'>
  <h3>Individual example</h3>
  <!-- 74 y.o. seen at baseline and 2 year fu -->

<p><img src="SinglePartNoCurve.png" alt="image"></p>

</section>
<section class='' data-state='' id='slide-15' data-transition='none'>
  <h3>Individual example</h3>
  <!-- 74 y.o. seen at baseline and 2 year fu -->

<p><img src="SinglePartCurve.png" alt="image"></p>

</section>
<section class='' data-state='' id='slide-16' data-transition='none'>
  <h3>Individual example</h3>
  <!-- 74 y.o. seen at baseline and 2 year fu, not seen again until the 4th wave -->

<!-- Look at the predicted curve - how can we measure how close we are? -->

<p><img src="SinglePartCurveIntervals.png" alt="image"></p>

</section>
<section class='' data-state='' id='slide-17'>
  <h3>Cross-validation study</h3>
  <ol>
<li>Withhold the last observation from a subset (test set) of individuals</li>
<li>Fit to the remaining data</li>
<li>Predict the distribution (MCMC) for future observations of the test set
individuals</li>
<li>Rinse and repeat</li>
</ol>

<ul>
<li>Data summaries:

<ul>
<li>Coverage of 95% posterior intervals</li>
<li>Widths of 95% PIs for forecast lengths \(h \in (0, H]\)</li>
</ul></li>
</ul>

</section>
<section class='' data-state='' id='slide-18'>
  <h3>Results (5 xvals)</h3>
  <ul>
<li>Coverage

<ul>
<li>95.4%</li>
</ul></li>
<li>By number of future waves:

<ul>
<li>97.0%, 93.9%, 100%</li>
</ul></li>
<li>10% loss &#39;alert&#39;

<ul>
<li>If predicted to have greater than 10% loss of BMD</li>
<li>Needs finessing</li>
<li>9.9%</li>
</ul></li>
</ul>

</section>
<section class='' data-state='' id='slide-19'>
  <h3>Width of forecast intervals</h3>
  <p><img src="PIWidths.png" alt="image"></p>

</section>
<section class='' data-state='' id='slide-20'>
  <h3>Is this information useful?</h3>
  <!-- Probably more useful is to give intervals and probabilities of events -->

<!-- happening, e.g. the probability of losing more than 5% BMD in a given -->

<!-- period. Can get this using posterior simulations. -->

<ul>
<li>Patients with osteopenia are advised to have a repeat bone scan every 1-2
years</li>
<li>Management could be helped by

<ul>
<li>Prediction intervals, say 80% and 95%</li>
<li>Probabilities of crossing a threshold, e.g. loss of more than 5% BMD over
the next 2 years</li>
</ul></li>
</ul>

</section>
<section class='' data-state='' id='slide-21' data-transition='none'>
  <h3>Example 1</h3>
  <p><img src="Alert1NoCurve.png" alt="image"></p>

</section>
<section class='' data-state='' id='slide-22' data-transition='none'>
  <h3>Example 1</h3>
  <p><img src="Alert1Curve.png" alt="image"></p>

</section>
<section class='' data-state='' id='slide-23' data-transition='none'>
  <h3>Example 1</h3>
  <p><img src="Alert1CurveIntervals.png" alt="image"></p>

</section>
<section class='' data-state='' id='slide-24' data-transition='none'>
  <h3>Example 2</h3>
  <p><img src="Alert2NoCurve.png" alt="image"></p>

</section>
<section class='' data-state='' id='slide-25' data-transition='none'>
  <h3>Example 2</h3>
  <p><img src="Alert2Curve.png" alt="image"></p>

</section>
<section class='' data-state='' id='slide-26' data-transition='none'>
  <h3>Example 2</h3>
  <p><img src="Alert2CurveIntervals.png" alt="image"></p>

<p></section></p>

</section>
<section class='' data-state='' id='slide-27'>

  <p><section></p>

<h2>Where to from here?</h2>

</section>
<section class='' data-state='' id='slide-28'>
  <h3>What is the impact of an acute event?</h3>
  <!-- ICU stay, are these any different? Give what I'm thinking, then perhaps -->

<!-- note the landmarking work, and the Stat. Med. paper just out -->

<ul>
<li>There&#39;s some evidence to suggest that an ICU stay has an impact on bone loss

<ul>
<li>How can we investigate this?</li>
</ul></li>
<li>Prospectively?

<ul>
<li>No pre-ICU BMD baseline (best is 2-4 weeks following, if they come in)</li>
</ul></li>
<li>GOS + ICU linkage

<ul>
<li>Regular measurements before and (hopefully) after</li>
</ul></li>
<li>But:

<ul>
<li>Different ages when the ICU event occurs</li>
<li>Different stages in terms of the GOS measurement schedule</li>
</ul></li>
</ul>

</section>
<section class='' data-state='' id='slide-29'>
  <h3>Effect of acute events: possible approach</h3>
  <!-- Definitely early work -->

<ul>
<li>Take the prediction/forecasting approach outlined previously:</li>
</ul>

<ol>
<li><p>Withhold all BMD measurements post-ICU event</p></li>
<li><p>Fit to the remaining data</p></li>
<li><p>Predict the distribution (MCMC) for future observations of the ICU</p></li>
</ol>

<ul>
<li>What to do with this distribution?

<ul>
<li>Probability of the known post-ICU measurement given the pre-ICU BMD
trajectory</li>
</ul></li>
</ul>

</section>
<section class='' data-state='' id='slide-30'>
  <h3>Are those with an acute event just &#39;different&#39;?</h3>
  <ul>
<li>Is it just that those with an event have a different trajectory fullstop?</li>
<li>Unsupervised learning on trajectories and check labels?</li>
</ul>

<p></section></p>

</section>
    </div>
  </div>
</body>
  <script src="../libraries/frameworks/revealjs/lib/js/head.min.js"></script>
  <script src="../libraries/frameworks/revealjs/js/reveal.min.js"></script>
  <script>
  // Full list of configuration options available here:
  // https://github.com/hakimel/reveal.js#configuration
  Reveal.initialize({
    controls: true,
    progress: true,
    history: true,
    center: true,
    width: 1280,
    height: 960,
    theme: Reveal.getQueryHash().theme || 'sky',
    transition: Reveal.getQueryHash().transition || 'cube',
    dependencies: [
    // Cross-browser shim that fully implements classList -
    // https://github.com/eligrey/classList.js/
      { src: '../libraries/frameworks/revealjs/lib/js/classList.js', condition: function() { return !document.body.classList;}},
      // Zoom in and out with Alt+click
      { src: '../libraries/frameworks/revealjs/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
      // Speaker notes
      { src: '../libraries/frameworks/revealjs/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },
      // Remote control your reveal.js presentation using a touch device
      //{ src: '../libraries/frameworks/revealjs/plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
      ]
  });
  </script>  <!-- MathJax: Fall back to local if CDN offline but local image fonts are not supported (saves >100MB) -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<!-- <script src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script> -->
<script>window.MathJax || document.write('<script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS":{imageFont:null}});<\/script><script src="../libraries/widgets/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"><\/script>')
</script>
<!-- LOAD HIGHLIGHTER JS FILES -->
<script src="../libraries/highlighters/highlight.js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<!-- DONE LOADING HIGHLIGHTER JS FILES -->


</html>
